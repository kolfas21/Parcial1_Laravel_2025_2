# API REST - Sistema de Gesti√≥n de Libros y Categor√≠as# TALLER LARAVEL API - Sistema de Gesti√≥n de Libros



Este proyecto es una API REST desarrollada con Laravel para la gesti√≥n de una biblioteca de libros con categor√≠as, implementando todas las operaciones CRUD (Create, Read, Update, Delete) y relaciones entre entidades.Este proyecto es una API REST desarrollada con Laravel para la gesti√≥n de una biblioteca de libros, implementando todas las operaciones CRUD (Create, Read, Update, Delete).



## üìã Caracter√≠sticas Implementadas## üìã Caracter√≠sticas Implementadas



### 1. ‚úÖ Base de Datos Relacional### 1. ‚úÖ Migraci√≥n de Base de Datos

- **Tabla `categories`:**- Tabla `books` con las siguientes columnas (exactamente como se especifica en el diagrama):

  - `id_category` (bigint, primary key, auto-increment)  - `id_book` (bigint, primary key, auto-increment)

  - `category_name` (varchar, required)  - `book_name` (varchar, required)

  - `category_description` (text, required)    - `book_author_name` (varchar, required)  

  - `category_priority` (integer, required)  - `book_price` (double, required)

  - `category_status` (boolean, required)  - `book_stock` (integer, required)

  - `book_status` (boolean, required)

- **Tabla `books`:**

  - `id_book` (bigint, primary key, auto-increment)### 2. ‚úÖ Modelo Eloquent

  - `book_name` (varchar, required)- Modelo `Book` con propiedad `$fillable` definida

  - `book_author_name` (varchar, required)  - Cast autom√°tico de tipos de datos

  - `book_price` (double, required)- Trait `HasFactory` para trabajar con factories

  - `book_stock` (integer, required)

  - `book_status` (boolean, required)### 3. ‚úÖ Controlador API Resource

  - `category_id` (bigint, foreign key nullable)- `BookController` con los 5 m√©todos b√°sicos:

  - `barcode` (varchar, nullable)  - `index()` - Listar todos los libros

  - `store()` - Crear un nuevo libro

**Relaci√≥n:** Una categor√≠a puede tener muchos libros (1:N). Los libros pueden existir sin categor√≠a.  - `show()` - Mostrar un libro espec√≠fico  

  - `update()` - Actualizar un libro existente

### 2. ‚úÖ Modelos Eloquent  - `destroy()` - Eliminar un libro

- **Modelo `Category`** con relaci√≥n `hasMany(Book)`

- **Modelo `Book`** con relaci√≥n `belongsTo(Category)`### 4. ‚úÖ Form Requests

- Cast autom√°tico de tipos de datos (boolean, double)- `StoreBookRequest` - Validaci√≥n para crear libros

- Trait `HasFactory` para trabajar con factories- `UpdateBookRequest` - Validaci√≥n para actualizar libros

- Reglas de validaci√≥n personalizadas con mensajes en espa√±ol

### 3. ‚úÖ Controladores API Resource

- **`CategoryController`** con CRUD completo + m√©todo personalizado### 5. ‚úÖ Rutas API Resource  

- **`BookController`** con CRUD completo + eager loading de categor√≠a- Rutas registradas en `routes/api.php`

- Respuestas JSON con c√≥digos HTTP apropiados- Utilizando `Route::apiResource('books', BookController::class)`



### 4. ‚úÖ Form Requests### 6. ‚úÖ Factory

- `StoreCategoryRequest` / `UpdateCategoryRequest`- `BookFactory` para generar datos falsos/dummy

- `StoreBookRequest` / `UpdateBookRequest`- Utiliza Faker para crear datos realistas

- Validaci√≥n de relaciones (foreign key exists)

- Mensajes de error personalizados en espa√±ol### 7. ‚úÖ Seeder

- `BookSeeder` que utiliza el factory para crear 20 libros de ejemplo

### 5. ‚úÖ Rutas API Resource  - Registrado en `DatabaseSeeder` para ejecuci√≥n autom√°tica

- Rutas para categor√≠as y libros

- Ruta personalizada para categor√≠as activas con sus libros## üöÄ Instalaci√≥n y Configuraci√≥n

- Registradas en `routes/api.php`

### Requisitos

### 6. ‚úÖ Factories- PHP 8.1+

- `CategoryFactory` - Genera categor√≠as con datos realistas- PostgreSQL

- `BookFactory` - Genera libros con c√≥digos de barras EAN-13- Composer



### 7. ‚úÖ Seeders### Pasos de instalaci√≥n

- `CategorySeeder` - Crea 10 categor√≠as

- `BookSeeder` - Crea 20 libros con categor√≠as asignadas1. **Clonar el repositorio**

- Orden de ejecuci√≥n respetando dependencias (categor√≠as primero)   ```bash

   git clone [url-del-repositorio]

## üöÄ Instalaci√≥n y Configuraci√≥n   cd TALLER-LARAVEL-API

   ```

### Requisitos

- PHP >= 8.22. **Instalar dependencias**

- PostgreSQL >= 12   ```bash

- Composer   composer install

   ```

### Pasos de instalaci√≥n

3. **Configurar base de datos**

1. **Clonar el repositorio**   Editar el archivo `.env` con las siguientes credenciales:

   ```bash   ```env

   git clone [url-del-repositorio]   DB_CONNECTION=pgsql

   cd Parcial1_Laravel   DB_HOST=127.0.0.1

   ```   DB_PORT=5432

   DB_DATABASE=laravel

2. **Instalar dependencias**   DB_USERNAME=postgres

   ```bash   DB_PASSWORD=950430

   composer install   ```

   ```

4. **Ejecutar migraciones**

3. **Configurar variables de entorno**   ```bash

   ```bash   php artisan migrate

   cp .env.example .env   ```

   php artisan key:generate

   ```5. **Poblar la base de datos con datos de ejemplo**

   ```bash

4. **Configurar base de datos**   php artisan db:seed --class=BookSeeder

   Editar el archivo `.env`:   ```

   ```env

   DB_CONNECTION=pgsql6. **Iniciar el servidor de desarrollo**

   DB_HOST=127.0.0.1   ```bash

   DB_PORT=5432   php artisan serve

   DB_DATABASE=laravel   ```

   DB_USERNAME=postgres

   DB_PASSWORD=tu_contrase√±a## üìö Documentaci√≥n de la API

   ```

### Base URL

5. **Ejecutar migraciones**```

   ```bashhttp://127.0.0.1:8000/api

   php artisan migrate```

   ```

### Endpoints Disponibles

6. **Poblar la base de datos con datos de ejemplo**

   ```bash| M√©todo | Endpoint | Descripci√≥n |

   php artisan db:seed|--------|----------|-------------|

   ```| GET    | `/books` | Obtener todos los libros |

| POST   | `/books` | Crear un nuevo libro |

7. **Iniciar el servidor de desarrollo**| GET    | `/books/{id}` | Obtener un libro espec√≠fico |

   ```bash| PUT/PATCH | `/books/{id}` | Actualizar un libro |

   php artisan serve| DELETE | `/books/{id}` | Eliminar un libro |

   ```

### Ejemplos de Uso

## üìö Documentaci√≥n de la API

#### 1. Obtener todos los libros

### Base URL```bash

```curl -X GET http://127.0.0.1:8000/api/books

http://127.0.0.1:8000/api```

```

#### 2. Crear un nuevo libro

### Endpoints Disponibles```bash

curl -X POST http://127.0.0.1:8000/api/books \

#### Categor√≠as  -H "Content-Type: application/json" \

  -d '{

| M√©todo | Endpoint | Descripci√≥n |    "book_name": "El Quijote de La Mancha",

|--------|----------|-------------|    "book_author_name": "Miguel de Cervantes",

| GET    | `/categories` | Listar todas las categor√≠as |    "book_price": 25.99,

| POST   | `/categories` | Crear nueva categor√≠a |    "book_stock": 15,

| GET    | `/categories/{id}` | Ver detalle de categor√≠a |    "book_status": true

| PUT/PATCH | `/categories/{id}` | Actualizar categor√≠a |  }'

| DELETE | `/categories/{id}` | Eliminar categor√≠a |```

| GET    | `/categories/active/with-books` | Listar categor√≠as activas con sus libros |

#### 3. Obtener un libro espec√≠fico

#### Libros```bash

curl -X GET http://127.0.0.1:8000/api/books/1

| M√©todo | Endpoint | Descripci√≥n |```

|--------|----------|-------------|

| GET    | `/books` | Listar todos los libros |#### 4. Actualizar un libro

| POST   | `/books` | Crear nuevo libro |```bash

| GET    | `/books/{id}` | Ver detalle de libro (incluye categor√≠a) |curl -X PUT http://127.0.0.1:8000/api/books/1 \

| PUT/PATCH | `/books/{id}` | Actualizar libro |  -H "Content-Type: application/json" \

| DELETE | `/books/{id}` | Eliminar libro |  -d '{

    "book_name": "Don Quijote de La Mancha - Edici√≥n Especial",

### Ejemplos de Uso    "book_price": 29.99,

    "book_stock": 20

#### 1. Listar todas las categor√≠as  }'

```bash```

GET http://127.0.0.1:8000/api/categories

```#### 5. Eliminar un libro

```bash

**Respuesta:**curl -X DELETE http://127.0.0.1:8000/api/books/1

```json```

[

  {## üìù Reglas de Validaci√≥n

    "id_category": 1,

    "category_name": "Ciencia Ficci√≥n",### Para crear un libro (POST):

    "category_description": "Libros de ciencia ficci√≥n y fantas√≠a",- `book_name`: Obligatorio, m√°ximo 255 caracteres

    "category_priority": 8,- `book_author_name`: Obligatorio, m√°ximo 255 caracteres

    "category_status": true- `book_price`: Obligatorio, num√©rico, m√≠nimo 0

  }- `book_stock`: Obligatorio, entero, m√≠nimo 0

]- `book_status`: Obligatorio, booleano

```

### Para actualizar un libro (PUT/PATCH):

#### 2. Crear una nueva categor√≠a- `book_name`: Opcional, m√°ximo 255 caracteres

```bash- `book_author_name`: Opcional, m√°ximo 255 caracteres

POST http://127.0.0.1:8000/api/categories- `book_price`: Opcional, num√©rico, m√≠nimo 0

Content-Type: application/json- `book_stock`: Opcional, entero, m√≠nimo 0

- `book_status`: Opcional, booleano

{

  "category_name": "Novela Hist√≥rica",## üóÉÔ∏è Estructura del Proyecto

  "category_description": "Novelas ambientadas en diferentes √©pocas hist√≥ricas",

  "category_priority": 5,```

  "category_status": trueapp/

}‚îú‚îÄ‚îÄ Http/

```‚îÇ   ‚îú‚îÄ‚îÄ Controllers/

‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ BookController.php

**Respuesta (201 Created):**‚îÇ   ‚îî‚îÄ‚îÄ Requests/

```json‚îÇ       ‚îú‚îÄ‚îÄ StoreBookRequest.php

{‚îÇ       ‚îî‚îÄ‚îÄ UpdateBookRequest.php

  "id_category": 11,‚îî‚îÄ‚îÄ Models/

  "category_name": "Novela Hist√≥rica",    ‚îî‚îÄ‚îÄ Book.php

  "category_description": "Novelas ambientadas en diferentes √©pocas hist√≥ricas",

  "category_priority": 5,database/

  "category_status": true‚îú‚îÄ‚îÄ factories/

}‚îÇ   ‚îî‚îÄ‚îÄ BookFactory.php

```‚îú‚îÄ‚îÄ migrations/

‚îÇ   ‚îî‚îÄ‚îÄ 2025_09_29_012139_create_books_table.php

#### 3. Obtener categor√≠as activas con sus libros‚îî‚îÄ‚îÄ seeders/

```bash    ‚îú‚îÄ‚îÄ BookSeeder.php

GET http://127.0.0.1:8000/api/categories/active/with-books    ‚îî‚îÄ‚îÄ DatabaseSeeder.php

```

routes/

**Respuesta:**‚îî‚îÄ‚îÄ api.php

```json```

[

  {## üß™ Datos de Ejemplo

    "id_category": 1,

    "category_name": "Ciencia Ficci√≥n",El proyecto incluye un seeder que crea autom√°ticamente 20 libros con datos falsos pero realistas, incluyendo:

    "category_description": "Libros de ciencia ficci√≥n y fantas√≠a",- T√≠tulos generados autom√°ticamente

    "category_priority": 8,- Nombres de autores ficticios

    "category_status": true,- ISBNs √∫nicos de 13 d√≠gitos

    "books": [- Precios entre $9.99 y $999.99

      {- Stock entre 0 y 100 unidades

        "id_book": 1,- Fechas de publicaci√≥n de los √∫ltimos 20 a√±os

        "book_name": "Dune",- Editoriales ficticias

        "book_author_name": "Frank Herbert",- Idiomas variados (es, en, fr, de, pt)

        "book_price": 25.99,- P√°ginas entre 50 y 1200

        "book_stock": 15,- Disponibilidad aleatoria (80% disponibles)

        "book_status": true,

        "category_id": 1,## ‚ú® Caracter√≠sticas T√©cnicas

        "barcode": "9780441172719"

      }- **Framework**: Laravel 11

    ]- **Base de datos**: PostgreSQL

  }- **Autenticaci√≥n**: Laravel Sanctum (configurado)

]- **Validaci√≥n**: Form Requests con reglas personalizadas

```- **Respuestas**: JSON para todas las operaciones

- **C√≥digos HTTP**: Implementaci√≥n correcta de c√≥digos de estado

#### 4. Crear un nuevo libro- **Factory & Seeder**: Generaci√≥n autom√°tica de datos de prueba

```bash

POST http://127.0.0.1:8000/api/books## üéØ Cumplimiento de Requisitos

Content-Type: application/json

‚úÖ **1. Migraci√≥n de tabla con restricciones de tipos de datos**  

{‚úÖ **2. Modelo Eloquent con $fillable definido**  

  "book_name": "1984",‚úÖ **3. Controlador API Resource con 5 m√©todos b√°sicos**  

  "book_author_name": "George Orwell",‚úÖ **4. Form Requests para validaci√≥n de creaci√≥n y actualizaci√≥n**  

  "book_price": 18.50,‚úÖ **5. Rutas apiResource para operaciones CRUD**  

  "book_stock": 25,‚úÖ **6. Factory para datos falsos/dummy**  

  "book_status": true,‚úÖ **7. Seeder implementado para llamado del factory**  

  "category_id": 1,

  "barcode": "9780451524935"## üîß Comandos √ötiles

}

``````bash

# Ver todas las rutas

**Respuesta (201 Created):**php artisan route:list

```json

{# Ver solo rutas de API

  "id_book": 21,php artisan route:list --path=api

  "book_name": "1984",

  "book_author_name": "George Orwell",# Ejecutar migraciones

  "book_price": 18.50,php artisan migrate

  "book_stock": 25,

  "book_status": true,# Ejecutar seeders

  "category_id": 1,php artisan db:seed

  "barcode": "9780451524935"

}# Ejecutar solo BookSeeder

```php artisan db:seed --class=BookSeeder



#### 5. Obtener un libro con su categor√≠a# Generar nueva clave de aplicaci√≥n

```bashphp artisan key:generate

GET http://127.0.0.1:8000/api/books/1

```# Limpiar cache

php artisan cache:clear

**Respuesta:**php artisan config:clear

```jsonphp artisan route:clear

{```

  "id_book": 1,

  "book_name": "Dune",---

  "book_author_name": "Frank Herbert",

  "book_price": 25.99,**Desarrollo completado siguiendo exactamente las instrucciones del taller Laravel API.**
  "book_stock": 15,
  "book_status": true,
  "category_id": 1,
  "barcode": "9780441172719",
  "category": {
    "id_category": 1,
    "category_name": "Ciencia Ficci√≥n",
    "category_description": "Libros de ciencia ficci√≥n y fantas√≠a",
    "category_priority": 8,
    "category_status": true
  }
}
```

#### 6. Actualizar un libro
```bash
PUT http://127.0.0.1:8000/api/books/1
Content-Type: application/json

{
  "book_price": 22.99,
  "book_stock": 30
}
```

**Respuesta (200 OK):**
```json
{
  "id_book": 1,
  "book_name": "Dune",
  "book_author_name": "Frank Herbert",
  "book_price": 22.99,
  "book_stock": 30,
  "book_status": true,
  "category_id": 1,
  "barcode": "9780441172719"
}
```

#### 7. Eliminar una categor√≠a
```bash
DELETE http://127.0.0.1:8000/api/categories/5
```

**Respuesta (204 No Content)**

## üìù Reglas de Validaci√≥n

### Para crear una categor√≠a (POST):
- `category_name`: Obligatorio, string, m√°ximo 255 caracteres
- `category_description`: Obligatorio, string
- `category_priority`: Obligatorio, entero, m√≠nimo 0
- `category_status`: Obligatorio, booleano

### Para actualizar una categor√≠a (PUT/PATCH):
- Todos los campos son opcionales
- Mismas reglas de validaci√≥n cuando se env√≠an

### Para crear un libro (POST):
- `book_name`: Obligatorio, string, m√°ximo 255 caracteres
- `book_author_name`: Obligatorio, string, m√°ximo 255 caracteres
- `book_price`: Obligatorio, num√©rico, m√≠nimo 0
- `book_stock`: Obligatorio, entero, m√≠nimo 0
- `book_status`: Obligatorio, booleano
- `category_id`: Opcional, debe existir en la tabla categories
- `barcode`: Opcional, string, m√°ximo 255 caracteres

### Para actualizar un libro (PUT/PATCH):
- Todos los campos son opcionales
- Mismas reglas de validaci√≥n cuando se env√≠an
- `category_id`: Valida que exista si se env√≠a

## üóÉÔ∏è Estructura del Proyecto

```
app/
‚îú‚îÄ‚îÄ Http/
‚îÇ   ‚îú‚îÄ‚îÄ Controllers/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ BookController.php
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ CategoryController.php
‚îÇ   ‚îî‚îÄ‚îÄ Requests/
‚îÇ       ‚îú‚îÄ‚îÄ StoreBookRequest.php
‚îÇ       ‚îú‚îÄ‚îÄ UpdateBookRequest.php
‚îÇ       ‚îú‚îÄ‚îÄ StoreCategoryRequest.php
‚îÇ       ‚îî‚îÄ‚îÄ UpdateCategoryRequest.php
‚îî‚îÄ‚îÄ Models/
    ‚îú‚îÄ‚îÄ Book.php
    ‚îî‚îÄ‚îÄ Category.php

database/
‚îú‚îÄ‚îÄ factories/
‚îÇ   ‚îú‚îÄ‚îÄ BookFactory.php
‚îÇ   ‚îî‚îÄ‚îÄ CategoryFactory.php
‚îú‚îÄ‚îÄ migrations/
‚îÇ   ‚îú‚îÄ‚îÄ 2025_09_29_012139_create_books_table.php
‚îÇ   ‚îú‚îÄ‚îÄ 2025_10_06_231210_create_categories_table.php
‚îÇ   ‚îî‚îÄ‚îÄ 2025_10_06_233020_add_category_id_and_barcode_to_books_table.php
‚îî‚îÄ‚îÄ seeders/
    ‚îú‚îÄ‚îÄ BookSeeder.php
    ‚îú‚îÄ‚îÄ CategorySeeder.php
    ‚îî‚îÄ‚îÄ DatabaseSeeder.php

routes/
‚îî‚îÄ‚îÄ api.php
```

## üß™ Datos de Ejemplo

El proyecto incluye seeders que crean autom√°ticamente:
- **10 categor√≠as** con nombres, descripciones, prioridades y estados variados
- **20 libros** con:
  - Nombres de autores ficticios
  - Precios variados
  - Stock entre 0 y 100 unidades
  - Estados aleatorios (80% activos)
  - C√≥digos de barras EAN-13 √∫nicos
  - Categor√≠as asignadas aleatoriamente

## ‚ú® Caracter√≠sticas T√©cnicas

- **Framework**: Laravel 12
- **Base de datos**: PostgreSQL
- **Autenticaci√≥n**: Laravel Sanctum (configurado pero no utilizado en este proyecto)
- **Validaci√≥n**: Form Requests con reglas personalizadas y mensajes en espa√±ol
- **Respuestas**: JSON para todas las operaciones
- **C√≥digos HTTP**: Implementaci√≥n correcta de c√≥digos de estado
- **Relaciones**: Eloquent ORM con eager loading
- **Factory & Seeder**: Generaci√≥n autom√°tica de datos de prueba

## üéØ Requisitos Implementados

‚úÖ **1. Tabla de Categor√≠as con 4 tipos de datos diferentes**  
‚úÖ **2. CRUD completo de Categor√≠as con controlador API Resource**  
‚úÖ **3. Validaci√≥n con Form Requests independientes (Store/Update)**  
‚úÖ **4. Relaci√≥n 1:N entre Categor√≠as y Libros (foreign key + barcode)**  
‚úÖ **5. Relaciones Eloquent bidireccionales (hasMany/belongsTo)**  
‚úÖ **6. Eager loading en m√©todo show() de libros**  
‚úÖ **7. Factory y Seeder para Categor√≠as con datos realistas**  
‚úÖ **8. M√©todo adicional: categor√≠as activas con sus libros**  

## üîß Comandos √ötiles

```bash
# Ver todas las rutas
php artisan route:list

# Ejecutar migraciones desde cero
php artisan migrate:fresh

# Ejecutar migraciones y seeders
php artisan migrate:fresh --seed

# Ejecutar solo seeders
php artisan db:seed

# Limpiar caches
php artisan cache:clear
php artisan config:clear
php artisan route:clear

# Ver detalles de una ruta espec√≠fica
php artisan route:list --path=books

# Ejecutar tests
php artisan test
```

## ‚ö†Ô∏è Notas Importantes

1. **Orden de Seeders**: Es cr√≠tico que `CategorySeeder` se ejecute ANTES que `BookSeeder` debido a la relaci√≥n de foreign key.

2. **Primary Keys Personalizadas**: Los modelos utilizan `id_category` e `id_book` en lugar del est√°ndar `id` de Laravel.

3. **Timestamps Deshabilitados**: Los modelos no utilizan timestamps autom√°ticos (`created_at`, `updated_at`).

4. **Foreign Key Nullable**: Los libros pueden existir sin categor√≠a asignada (`category_id` es nullable).

5. **Ruta Personalizada**: La ruta `/categories/active/with-books` debe estar definida ANTES de `apiResource` para evitar conflictos de rutas.

## üìä C√≥digos de Respuesta HTTP

| C√≥digo | Descripci√≥n | Uso |
|--------|-------------|-----|
| 200 | OK | Operaci√≥n exitosa (GET, PUT, PATCH) |
| 201 | Created | Recurso creado exitosamente (POST) |
| 204 | No Content | Eliminaci√≥n exitosa (DELETE) |
| 404 | Not Found | Recurso no encontrado |
| 422 | Unprocessable Entity | Errores de validaci√≥n |

---

**Proyecto desarrollado siguiendo las especificaciones del Primer Parcial Laravel - API**
